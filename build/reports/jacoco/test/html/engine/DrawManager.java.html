<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DrawManager.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">space_Invaders</a> &gt; <a href="index.source.html" class="el_package">engine</a> &gt; <span class="el_source">DrawManager.java</span></div><h1>DrawManager.java</h1><pre class="source lang-java linenums">package engine;

import java.awt.Color;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.image.BufferedImage;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Logger;

import animations.BasicGameSpace;
import animations.Explosion;
import animations.MenuSpace;
import engine.renderer.*;
import screen.Screen;

/**
 * Manages screen drawing.
 *
 * @author &lt;a href=&quot;mailto:RobertoIA1987@gmail.com&quot;&gt;Roberto Izquierdo Amo&lt;/a&gt;
 *
 */
public final class DrawManager {

    /** Singleton instance of the class. */
    private static DrawManager instance;
    /** Current frame. */
    private static Frame frame;
    /** FileManager instance. */
    private static FileManager fileManager;
    /** Application logger. */
    private final Logger LOGGER;
    /** Graphics context. */
    private static Graphics graphics;
    /** Buffer Graphics. */
    private static Graphics backBufferGraphics;
    /** Buffer image. */
    private static BufferedImage backBuffer;
    /** Normal-sized font. */
    private static Font fontRegular;
    /** Normal-sized font properties. */
    private static FontMetrics fontRegularMetrics;
    /** Big sized font. */
    private static Font fontBig;
    /** Big sized font properties. */
    private static FontMetrics fontBigMetrics;

    private AssetManager assetManager;
    // Common Renderer
    private CommonRenderer commonRenderer;
    private EntityRenderer entityRenderer;
    // Screen Renderer
    private TitleScreenRenderer titleScreenRenderer;
    private AchievementScreenRenderer achievementScreenRenderer;
    private HighScoreScreenRenderer highScoreScreenRenderer;
    private SettingScreenRenderer settingScreenRenderer;
    private PlayModeSelectionScreenRenderer playModeSelectionScreenRenderer;
    private ShipSelectionMenuRenderer shipSelectionMenuRenderer;
    private GameScreenRenderer gameScreenRenderer;
    private ScoreScreenRenderer scoreScreenRenderer;

<span class="nc" id="L63">    private final List&lt;Explosion&gt; explosions = new ArrayList&lt;&gt;();</span>

    /**
     * Stars background animations for both game and main menu
     * Star density specified as argument.
     */
<span class="nc" id="L69">    BasicGameSpace basicGameSpace = new BasicGameSpace(100);</span>
<span class="nc" id="L70">    MenuSpace menuSpace = new MenuSpace(50);</span>
<span class="nc" id="L71">    int explosion_size = 2;</span>

    /**
     * Private constructor.
     */
<span class="nc" id="L76">    private DrawManager() {</span>
        // Assets(resources) loader
<span class="nc" id="L78">        this.assetManager = AssetManager.getInstance();</span>
        // Common Renderer of all screen
<span class="nc" id="L80">        this.commonRenderer = new CommonRenderer();</span>
        // Renderer of entity
<span class="nc" id="L82">        this.entityRenderer = new EntityRenderer(this.commonRenderer);</span>
        // Renderer of each screens
<span class="nc" id="L84">        this.titleScreenRenderer = new TitleScreenRenderer(this.commonRenderer);</span>
<span class="nc" id="L85">        this.achievementScreenRenderer = new AchievementScreenRenderer(this.commonRenderer);</span>
<span class="nc" id="L86">        this.highScoreScreenRenderer = new HighScoreScreenRenderer(this.commonRenderer);</span>
<span class="nc" id="L87">        this.settingScreenRenderer = new SettingScreenRenderer(this.commonRenderer);</span>
<span class="nc" id="L88">        this.playModeSelectionScreenRenderer = new PlayModeSelectionScreenRenderer(this.commonRenderer);</span>
<span class="nc" id="L89">        this.shipSelectionMenuRenderer = new ShipSelectionMenuRenderer(this.commonRenderer);</span>
<span class="nc" id="L90">        this.gameScreenRenderer = new GameScreenRenderer(this.commonRenderer);</span>
<span class="nc" id="L91">        this.scoreScreenRenderer = new ScoreScreenRenderer(this.commonRenderer);</span>

<span class="nc" id="L93">        fontRegular = this.assetManager.getFontRegular();</span>
<span class="nc" id="L94">        fontBig = this.assetManager.getFontBig();</span>

<span class="nc" id="L96">        this.LOGGER = Core.getLogger();</span>
<span class="nc" id="L97">        LOGGER.info(&quot;Started loading resources.&quot;);</span>
<span class="nc" id="L98">    }</span>

    /**
     * Returns shared instance of DrawManager.
     *
     * @return Shared instance of DrawManager.
     */
    public static DrawManager getInstance() {
<span class="nc bnc" id="L106" title="All 2 branches missed.">        if (instance == null)</span>
<span class="nc" id="L107">            instance = new DrawManager();</span>
<span class="nc" id="L108">        return instance;</span>
    }

    public static Frame getFrame() {
<span class="nc" id="L112">        return frame;</span>
    }

    public Graphics getBackBufferGraphics() {
<span class="nc" id="L116">        return backBufferGraphics;</span>
    }

    public CommonRenderer getCommonRenderer() {
<span class="nc" id="L120">        return this.commonRenderer;</span>
    }

    public EntityRenderer getEntityRenderer() {
<span class="nc" id="L124">        return this.entityRenderer;</span>
    }

    public TitleScreenRenderer getTitleScreenRenderer() {
<span class="nc" id="L128">        return this.titleScreenRenderer;</span>
    }

    public AchievementScreenRenderer getAchievementScreenRenderer() {
<span class="nc" id="L132">        return this.achievementScreenRenderer;</span>
    }

    public HighScoreScreenRenderer getHighScoreScreenRenderer() {
<span class="nc" id="L136">        return this.highScoreScreenRenderer;</span>
    }

    public SettingScreenRenderer getSettingScreenRenderer() {
<span class="nc" id="L140">        return this.settingScreenRenderer;</span>
    }

    public PlayModeSelectionScreenRenderer getPlayModeSelectionScreenRenderer() {
<span class="nc" id="L144">        return this.playModeSelectionScreenRenderer;</span>
    }

    public ShipSelectionMenuRenderer getShipSelectionMenuRenderer() {
<span class="nc" id="L148">        return this.shipSelectionMenuRenderer;</span>
    }

    public GameScreenRenderer getGameScreenRenderer() {
<span class="nc" id="L152">        return this.gameScreenRenderer;</span>
    }

    public ScoreScreenRenderer getScoreScreenRenderer() {
<span class="nc" id="L156">        return this.scoreScreenRenderer;</span>
    }

    /**
     * Sets the frame to draw the image on.
     *
     * @param currentFrame
     *                     Frame to draw on.
     */
    public void setFrame(final Frame currentFrame) {
<span class="nc" id="L166">        frame = currentFrame;</span>
<span class="nc" id="L167">    }</span>

    /**
     * First part of the drawing process. Initialises buffers, draws the
     * background and prepares the images.
     *
     * @param screen
     *               Screen to draw in.
     */
    public void initDrawing(final Screen screen) {
<span class="nc" id="L177">        backBuffer = new BufferedImage(screen.getWidth(), screen.getHeight(), BufferedImage.TYPE_INT_RGB);</span>

<span class="nc" id="L179">        graphics = frame.getGraphics();</span>
<span class="nc" id="L180">        backBufferGraphics = backBuffer.getGraphics();</span>

<span class="nc" id="L182">        backBufferGraphics.setColor(Color.BLACK);</span>
<span class="nc" id="L183">        backBufferGraphics.fillRect(0, 0, screen.getWidth(), screen.getHeight());</span>

<span class="nc" id="L185">        fontRegularMetrics = backBufferGraphics.getFontMetrics(fontRegular);</span>
<span class="nc" id="L186">        fontBigMetrics = backBufferGraphics.getFontMetrics(fontBig);</span>

        // drawBorders(screen);
        // drawGrid(screen);
<span class="nc" id="L190">    }</span>

    /**
     * Draws the completed drawing on screen.
     *
     * @param screen
     *               Screen to draw on.
     */
    public void completeDrawing(final Screen screen) {
<span class="nc" id="L199">        graphics.drawImage(backBuffer, frame.getInsets().left, frame.getInsets().top, frame);</span>
<span class="nc" id="L200">    }</span>


    /**
     * For debugging purposes, draws the canvas borders.
     *
     * @param screen
     *               Screen to draw in.
     */
    @SuppressWarnings(&quot;unused&quot;)
    private void drawBorders(final Screen screen) {
<span class="nc" id="L211">        backBufferGraphics.setColor(Color.GREEN);</span>
<span class="nc" id="L212">        backBufferGraphics.drawLine(0, 0, screen.getWidth() - 1, 0);</span>
<span class="nc" id="L213">        backBufferGraphics.drawLine(0, 0, 0, screen.getHeight() - 1);</span>
<span class="nc" id="L214">        backBufferGraphics.drawLine(screen.getWidth() - 1, 0, screen.getWidth() - 1, screen.getHeight() - 1);</span>
<span class="nc" id="L215">        backBufferGraphics.drawLine(0, screen.getHeight() - 1, screen.getWidth() - 1, screen.getHeight() - 1);</span>
<span class="nc" id="L216">    }</span>

    /**
     * For debugging purposes, draws a grid over the canvas.
     *
     * @param screen
     *               Screen to draw in.
     */
    @SuppressWarnings(&quot;unused&quot;)
    private void drawGrid(final Screen screen) {
<span class="nc" id="L226">        backBufferGraphics.setColor(Color.DARK_GRAY);</span>
<span class="nc bnc" id="L227" title="All 2 branches missed.">        for (int i = 0; i &lt; screen.getHeight() - 1; i += 2)</span>
<span class="nc" id="L228">            backBufferGraphics.drawLine(0, i, screen.getWidth() - 1, i);</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">        for (int j = 0; j &lt; screen.getWidth() - 1; j += 2)</span>
<span class="nc" id="L230">            backBufferGraphics.drawLine(j, 0, j, screen.getHeight() - 1);</span>
<span class="nc" id="L231">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>