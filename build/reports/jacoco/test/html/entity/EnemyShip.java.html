<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EnemyShip.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">space_Invaders</a> &gt; <a href="index.source.html" class="el_package">entity</a> &gt; <span class="el_source">EnemyShip.java</span></div><h1>EnemyShip.java</h1><pre class="source lang-java linenums">package entity;

import java.awt.Color;

import engine.utils.Cooldown;
import engine.Core;
import engine.AssetManager.SpriteType;
import engine.GameSettings;


/**
 * Implements an enemy ship, to be destroyed by the player.
 *
 * @author &lt;a href=&quot;mailto:RobertoIA1987@gmail.com&quot;&gt;Roberto Izquierdo Amo&lt;/a&gt;
 *
 */
public class EnemyShip extends Entity {

    /** Point value of a type A enemy. */
    private static final int A_TYPE_POINTS = 10;
    /** Point value of a type B enemy. */
    private static final int B_TYPE_POINTS = 20;
    /** Point value of a type C enemy. */
    private static final int C_TYPE_POINTS = 30;
    /** Point value of a bonus enemy. */
    private static final int BONUS_TYPE_POINTS = 100;

    private static final int A_TYPE_COINS = 2;
    private static final int B_TYPE_COINS = 3;
    private static final int C_TYPE_COINS = 5;
    private static final int BONUS_TYPE_COINS = 10;

    /** Cooldown between sprite changes. */
    private Cooldown animationCooldown;
    private Cooldown bossAnimationCooldown;
    /** Checks if the ship has been hit by a bullet. */
    private boolean isDestroyed;
    /** Values of the ship, in points, when destroyed. */
    private int pointValue;

    private int coinValue;

    /** Current health of the enemy ship */
    private int health;
    private int initialHealth;

    /**
     * Constructor, establishes the ship's properties.
     *
     * @param positionX
     *            Initial position of the ship in the X axis.
     * @param positionY
     *            Initial position of the ship in the Y axis.
     * @param spriteType
     *            Sprite type, image corresponding to the ship.
     */
    public EnemyShip(final int positionX, final int positionY,
                     final SpriteType spriteType) {
<span class="nc" id="L59">        super(positionX, positionY, 12 * 2, 8 * 2, Color.WHITE);</span>

<span class="nc" id="L61">        this.spriteType = spriteType;</span>
<span class="nc" id="L62">        this.animationCooldown = Core.getCooldown(500);</span>
<span class="nc" id="L63">        this.bossAnimationCooldown = Core.getCooldown(500);</span>
<span class="nc" id="L64">        this.isDestroyed = false;</span>

<span class="nc bnc" id="L66" title="All 5 branches missed.">        switch (this.spriteType) {</span>
            case EnemyShipA1:
            case EnemyShipA2:
<span class="nc" id="L69">                this.pointValue = A_TYPE_POINTS;</span>
<span class="nc" id="L70">                this.coinValue = A_TYPE_COINS;</span>
<span class="nc" id="L71">                this.health = 2;</span>
<span class="nc" id="L72">                break;</span>
            case EnemyShipB1:
            case EnemyShipB2:
<span class="nc" id="L75">                this.pointValue = B_TYPE_POINTS;</span>
<span class="nc" id="L76">                this.coinValue = B_TYPE_COINS;</span>
<span class="nc" id="L77">                this.health = 1;</span>
<span class="nc" id="L78">                break;</span>
            case EnemyShipC1:
            case EnemyShipC2:
<span class="nc" id="L81">                this.pointValue = C_TYPE_POINTS;</span>
<span class="nc" id="L82">                this.coinValue = C_TYPE_COINS;</span>
<span class="nc" id="L83">                this.health = 1;</span>
<span class="nc" id="L84">                break;</span>
            case BossEnemy1:
            case BossEnemy2:
            case BossEnemy3:
<span class="nc" id="L88">                this.pointValue = 1000;</span>
<span class="nc" id="L89">                this.coinValue = 1000;</span>
<span class="nc" id="L90">                this.health = 50;</span>
<span class="nc" id="L91">                break;</span>
            default:
<span class="nc" id="L93">                this.pointValue = 0;</span>
<span class="nc" id="L94">                this.coinValue = 0;</span>
<span class="nc" id="L95">                this.health = 1;</span>
                break;
        }

<span class="nc" id="L99">        this.initialHealth = this.health;</span>
<span class="nc" id="L100">    }</span>

    public void changeShip(GameSettings.ChangeData changeData) {
<span class="nc" id="L103">        this.health *= changeData.hp;</span>
<span class="nc" id="L104">        this.initialHealth = this.health;</span>

<span class="nc" id="L106">        this.changeColor(changeData.color);</span>

<span class="nc" id="L108">        this.pointValue *= changeData.multiplier;</span>
<span class="nc" id="L109">        this.coinValue *= changeData.multiplier;</span>
<span class="nc" id="L110">    }</span>

    /**
     * Constructor, establishes the ship's properties for a special ship, with
     * known starting properties.
     */
    public EnemyShip() {
<span class="nc" id="L117">        super(-32, 80, 16 * 2, 7 * 2, Color.RED);</span>

<span class="nc" id="L119">        this.spriteType = SpriteType.EnemyShipSpecial;</span>
<span class="nc" id="L120">        this.isDestroyed = false;</span>
<span class="nc" id="L121">        this.pointValue = BONUS_TYPE_POINTS;</span>
<span class="nc" id="L122">        this.coinValue = BONUS_TYPE_COINS;</span>
<span class="nc" id="L123">        this.health = 1;</span>
<span class="nc" id="L124">    }</span>

    /**
     * Getter for the score bonus if this ship is destroyed.
     *
     * @return Value of the ship.
     */
    public final int getPointValue() {
<span class="nc" id="L132">        return this.pointValue;</span>
    }

    /**
     * Moves the ship the specified distance.
     *
     * @param distanceX
     *            Distance to move in the X axis.
     * @param distanceY
     *            Distance to move in the Y axis.
     */
    public final void move(final int distanceX, final int distanceY) {
<span class="nc" id="L144">        this.positionX += distanceX;</span>
<span class="nc" id="L145">        this.positionY += distanceY;</span>
<span class="nc" id="L146">    }</span>

    /**
     * Updates attributes, mainly used for animation purposes.
     */
    public final void update() {
<span class="nc bnc" id="L152" title="All 2 branches missed.">        if (this.animationCooldown.checkFinished()) {</span>
<span class="nc" id="L153">            this.animationCooldown.reset();</span>

<span class="nc bnc" id="L155" title="All 7 branches missed.">            switch (this.spriteType) {</span>
                case EnemyShipA1:
<span class="nc" id="L157">                    this.spriteType = SpriteType.EnemyShipA2;</span>
<span class="nc" id="L158">                    break;</span>
                case EnemyShipA2:
<span class="nc" id="L160">                    this.spriteType = SpriteType.EnemyShipA1;</span>
<span class="nc" id="L161">                    break;</span>
                case EnemyShipB1:
<span class="nc" id="L163">                    this.spriteType = SpriteType.EnemyShipB2;</span>
<span class="nc" id="L164">                    break;</span>
                case EnemyShipB2:
<span class="nc" id="L166">                    this.spriteType = SpriteType.EnemyShipB1;</span>
<span class="nc" id="L167">                    break;</span>
                case EnemyShipC1:
<span class="nc" id="L169">                    this.spriteType = SpriteType.EnemyShipC2;</span>
<span class="nc" id="L170">                    break;</span>
                case EnemyShipC2:
<span class="nc" id="L172">                    this.spriteType = SpriteType.EnemyShipC1;</span>
<span class="nc" id="L173">                    break;</span>
                default:
                    break;
            }
        }
<span class="nc" id="L178">    }</span>

    /** Returns the current health of the enemy ship */
    public int getHealth() {
<span class="nc" id="L182">        return this.health;</span>
    }

    /** Reduces enemy health by 1 and handles destruction or damage animation if health drops to 0 */

    public final void hit() {
<span class="nc" id="L188">        this.health--;</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">        if (this.health &lt;= 0) {</span>
<span class="nc" id="L190">            this.isDestroyed = true;</span>
<span class="nc" id="L191">            this.spriteType = SpriteType.Explosion;</span>
<span class="nc" id="L192">            Color color = this.getColor();</span>
<span class="nc" id="L193">            color = new Color(color.getRed(), color.getGreen(), color.getBlue(), 255);</span>
<span class="nc" id="L194">            changeColor(color);</span>
<span class="nc" id="L195">        }</span>

        else {
<span class="nc bnc" id="L198" title="All 4 branches missed.">            switch (this.spriteType) {</span>
                case EnemyShipA1:
                case EnemyShipA2:
<span class="nc" id="L201">                    this.spriteType = SpriteType.EnemyShipA2;</span>
<span class="nc" id="L202">                    break;</span>
                case EnemyShipB1:
                case EnemyShipB2:
<span class="nc" id="L205">                    this.spriteType = SpriteType.EnemyShipB2;</span>
<span class="nc" id="L206">                    break;</span>
                case EnemyShipC1:
                case EnemyShipC2:
<span class="nc" id="L209">                    this.spriteType = SpriteType.EnemyShipC2;</span>
<span class="nc" id="L210">                    break;</span>
                default:
                    break;
            }
<span class="nc" id="L214">            Color color = this.getColor();</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">            if(initialHealth != 0) {</span>
<span class="nc" id="L216">                int rawAlpha = (int)(70 + 150 * (float)health / initialHealth);</span>
<span class="nc" id="L217">                int alpha = Math.max(0, Math.min(255, rawAlpha));</span>
<span class="nc" id="L218">                color = new Color(color.getRed(), color.getGreen(), color.getBlue(), alpha);</span>
<span class="nc" id="L219">                changeColor(color);</span>
            }
        }
<span class="nc" id="L222">    }</span>

    public final int getDamage(int dmg){
<span class="nc" id="L225">        this.health -= dmg;</span>
<span class="nc" id="L226">        return this.health;</span>
    }

    /**
     * Destroys the ship, causing an explosion.
     */
    public final void destroy() {
<span class="nc" id="L233">        this.isDestroyed = true;</span>
<span class="nc" id="L234">        this.spriteType = SpriteType.Explosion;</span>
<span class="nc" id="L235">    }</span>

    /**
     * Checks if the ship has been destroyed.
     *
     * @return True if the ship has been destroyed.
     */
    public final boolean isDestroyed() {
<span class="nc" id="L243">        return this.isDestroyed;</span>
    }

<span class="nc" id="L246">    public int getCoinValue() { return this.coinValue; }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>