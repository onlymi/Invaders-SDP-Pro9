<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HitboxManager.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">space_Invaders</a> &gt; <a href="index.source.html" class="el_package">engine.hitbox</a> &gt; <span class="el_source">HitboxManager.java</span></div><h1>HitboxManager.java</h1><pre class="source lang-java linenums">package engine.hitbox;

import engine.AssetManager;
import screen.Screen;

import java.awt.*;

public class HitboxManager {

    private static HitboxManager instance;

    /** Normal-sized font. */
    private final Font fontRegular;
    /** Big sized font. */
    private final Font fontBig;
    /** Font properties. */
    private static FontMetrics fontMetrics;

    private static final String BACK_LABEL = &quot;&lt; Back&quot;;
    private static final int VOLUME_HITBOX_OFFSET = 20;

<span class="nc" id="L22">    private HitboxManager() {</span>
<span class="nc" id="L23">        this.fontRegular = AssetManager.getInstance().getFontRegular();</span>
<span class="nc" id="L24">        this.fontBig = AssetManager.getInstance().getFontBig();</span>
<span class="nc" id="L25">    }</span>

    public static HitboxManager getInstance() {
<span class="nc bnc" id="L28" title="All 2 branches missed.">        if (instance == null) {</span>
<span class="nc" id="L29">            instance = new HitboxManager();</span>
        }
<span class="nc" id="L31">        return instance;</span>
    }

    /**
     * hitbox coordinate function
     * @param g
     * @param screen
     * @return
     */
    public Rectangle[] getMenuHitboxes (Graphics g, final Screen screen) {
<span class="nc bnc" id="L41" title="All 2 branches missed.">        if (fontMetrics == null) {</span>
<span class="nc" id="L42">            g.setFont(this.fontRegular);</span>
<span class="nc" id="L43">            fontMetrics = g.getFontMetrics(this.fontRegular);</span>
        }

<span class="nc" id="L46">        final String[] buttons = {&quot;Play&quot;, &quot;Achievement&quot;, &quot;High scores&quot;, &quot;Settings&quot;, &quot;Exit&quot;};</span>

<span class="nc" id="L48">        int baseY = screen.getHeight() / 3 * 2 - 20;</span>
<span class="nc" id="L49">        int spacing = (int) (fontMetrics.getHeight() * 1.5);</span>
<span class="nc" id="L50">        Rectangle[] boxes= new Rectangle[buttons.length];</span>

<span class="nc bnc" id="L52" title="All 2 branches missed.">        for (int i = 0; i &lt; buttons.length; i++) {</span>
<span class="nc" id="L53">            int baseline = baseY + spacing * i;</span>
<span class="nc" id="L54">            boxes[i] = centeredStringBounds(g, screen, buttons[i], baseline);</span>
        }

<span class="nc" id="L57">        return boxes;</span>
    }

    public Rectangle[] getPlayModeSelectionMenuHitboxes(Graphics g, final Screen screen) {
<span class="nc bnc" id="L61" title="All 2 branches missed.">        if (fontMetrics == null) {</span>
<span class="nc" id="L62">            g.setFont(fontRegular);</span>
<span class="nc" id="L63">            fontMetrics = g.getFontMetrics(fontRegular);</span>
        }

<span class="nc" id="L66">        final String[] items = {&quot;1 Player&quot;, &quot;2 Players&quot;};</span>
<span class="nc" id="L67">        int baseY = screen.getHeight() / 2 - 20;</span>
<span class="nc" id="L68">        Rectangle[] boxes = new Rectangle[items.length];</span>

<span class="nc bnc" id="L70" title="All 2 branches missed.">        for (int i = 0; i &lt; items.length; i++) {</span>
<span class="nc" id="L71">            int baselineY = baseY + fontMetrics.getHeight() * 3 * i;</span>
<span class="nc" id="L72">            boxes[i] = centeredStringBounds(g, screen, items[i], baselineY);</span>
        }

<span class="nc" id="L75">        return boxes;</span>
    }

    public Rectangle getVolumeBarHitbox(final Screen screen){
<span class="nc" id="L79">        int bar_startWidth = screen.getWidth() / 2;</span>
<span class="nc" id="L80">        int bar_endWidth = screen.getWidth() - 40;</span>
<span class="nc" id="L81">        int barHeight = screen.getHeight() * 3 / 10;</span>

<span class="nc" id="L83">        int barThickness = 20;</span>

<span class="nc" id="L85">        int centerY = barHeight + VOLUME_HITBOX_OFFSET;</span>

<span class="nc" id="L87">        int x = bar_startWidth;</span>
<span class="nc" id="L88">        int y = centerY - barThickness;</span>
<span class="nc" id="L89">        int width = bar_endWidth - bar_startWidth;</span>
<span class="nc" id="L90">        int height = barThickness * 2;</span>

<span class="nc" id="L92">        return new Rectangle(x, y, width, height);</span>
    }

    /**
     * hitbox for Back button
     */
    public Rectangle getBackButtonHitbox(Graphics g, final Screen screen) {
<span class="nc" id="L99">        g.setFont(fontRegular);</span>
<span class="nc" id="L100">        fontMetrics = g.getFontMetrics(fontRegular);</span>

<span class="nc" id="L102">        int margin = screen.getWidth() / 15;</span>
<span class="nc" id="L103">        int ascent = fontMetrics.getAscent();</span>
<span class="nc" id="L104">        int descent = fontMetrics.getDescent();</span>
<span class="nc" id="L105">        int padTop = 2;</span>

<span class="nc" id="L107">        int y = margin - padTop;</span>
<span class="nc" id="L108">        int w = fontMetrics.stringWidth(BACK_LABEL);</span>
<span class="nc" id="L109">        int h = ascent + descent + 25;</span>

<span class="nc" id="L111">        return new Rectangle(margin, y, w, h);</span>
    }

    /**
     * When a given string is aligned in the middle of the screen,
     * the pixel area occupied by the string is calculated as Rectangle and returned
     */
    public Rectangle centeredStringBounds(Graphics g, final Screen screen, final String string, final int baselineY) {
<span class="nc" id="L119">        g.setFont(fontRegular);</span>
<span class="nc" id="L120">        fontMetrics = g.getFontMetrics(fontRegular);</span>
        // Variables for hitbox fine-tuning
<span class="nc" id="L122">        int menuHitboxOffset = 20;</span>

<span class="nc" id="L124">        final int pad = 4;</span>
<span class="nc" id="L125">        int textWidth = fontMetrics.stringWidth(string);</span>
<span class="nc" id="L126">        int ascent = fontMetrics.getAscent();</span>
<span class="nc" id="L127">        int descent = fontMetrics.getDescent();</span>

<span class="nc" id="L129">        int x = screen.getWidth() / 2 - textWidth / 2;</span>
<span class="nc" id="L130">        int y = baselineY - ascent + menuHitboxOffset - pad / 2;</span>
<span class="nc" id="L131">        int h = ascent + descent + pad;</span>

<span class="nc" id="L133">        return new Rectangle(x, y, textWidth, h);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>